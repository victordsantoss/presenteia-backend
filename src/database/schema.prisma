generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "rhel-openssl-3.0.x", "linux-arm64-openssl-3.0.x"]
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}


model User {
  id            String         @id @default(cuid())
  name          String         @db.VarChar(255)
  email         String         @db.VarChar(255)
  cpf           String         @db.VarChar(14)
  password      String         @db.VarChar(255)
  isActive      Boolean        @default(true)
  provider      String         @default("LOCAL") @db.VarChar
  birthDate     DateTime?      @db.Date
  createdAt     DateTime       @default(now()) @db.Timestamp(6)
  updatedAt     DateTime       @default(now()) @db.Timestamp(6)
  deletedAt     DateTime?      @db.Timestamp(6)
  roleId        String?
  sessions      Session[]
  role          Role?          @relation(fields: [roleId], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Role {
  id        String    @id @default(cuid())
  name      RoleTypes @default(USER)
  isActive  Boolean   @default(true)
  createdAt DateTime  @default(now()) @db.Timestamp(6)
  updatedAt DateTime  @default(now()) @db.Timestamp(6)
  users     User[]
}

model Session {
  id        String    @id @default(cuid())
  token     String    @db.VarChar(500)
  type      String    @db.VarChar(100)
  ipAddress String?   @db.VarChar(45)
  isActive  Boolean   @default(true)
  startDate DateTime  @db.Timestamp(6)
  endDate   DateTime? @db.Timestamp(6)
  userId    String?
  user      User?     @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

enum RoleTypes {
  SADMIN  @map("SADMIN")
  ADMIN   @map("ADMIN")
  USER    @map("USER")
  MANAGER @map("MANAGER")
  GUEST   @map("GUEST")
}


